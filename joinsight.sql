SELECT "t1"."用户活跃表_用户名称_5" AS "用户名称", "t1"."用户活跃表_用户id_3" AS "用户id", "t1"."最后访问时间", "t1"."累计访问天数", "t1"."访问次数", "t1"."统计日期", "t1"."用户活跃表_访问时长_4" AS "访问时长", "t7"."访问次数的累计求和"
FROM (SELECT "用户活跃表"."累计访问天数" AS "用户活跃表_累计访问天数_1", "用户活跃表"."访问次数" AS "用户活跃表_访问次数_2", "用户活跃表"."用户id" AS "用户活跃表_用户id_3", "用户活跃表"."访问时长" AS "用户活跃表_访问时长_4", "用户活跃表"."用户名称" AS "用户活跃表_用户名称_5", "用户活跃表"."最后访问时间" AS "用户活跃表_最后访问时间_6", "用户活跃表"."统计日期" AS "用户活跃表_统计日期_7", "用户活跃表"."最后访问时间", "用户活跃表"."累计访问天数", "用户活跃表"."访问次数", "用户活跃表"."用户id", "用户活跃表"."统计日期", "用户活跃表"."访问时长", "用户活跃表"."用户名称", COALESCE("用户活跃表"."访问时长", 0) AS "f14", ("用户活跃表"."访问时长") IS NOT NULL AS "f15", COALESCE("用户活跃表"."统计日期", TRY_CAST('1970-01-01' AS DATE)) AS "f16", ("用户活跃表"."统计日期") IS NOT NULL AS "f17", COALESCE("用户活跃表"."访问次数", 0) AS "f18", ("用户活跃表"."访问次数") IS NOT NULL AS "f19", COALESCE("用户活跃表"."最后访问时间", TRY_CAST('1970-01-01 00:00:00' AS TIMESTAMP(0))) AS "f20", ("用户活跃表"."最后访问时间") IS NOT NULL AS "f21", COALESCE("用户活跃表"."统计日期", TRY_CAST('1970-01-01' AS DATE)) AS "f22", ("用户活跃表"."统计日期") IS NOT NULL AS "f23", COALESCE("用户活跃表"."访问次数", 0) AS "f24", ("用户活跃表"."访问次数") IS NOT NULL AS "f25", COALESCE("用户活跃表"."访问时长", 0) AS "f26", ("用户活跃表"."访问时长") IS NOT NULL AS "f27", COALESCE("用户活跃表"."累计访问天数", 0) AS "f28", ("用户活跃表"."累计访问天数") IS NOT NULL AS "f29", COALESCE("用户活跃表"."累计访问天数", 0) AS "f30", ("用户活跃表"."累计访问天数") IS NOT NULL AS "f31", COALESCE("用户活跃表"."最后访问时间", TRY_CAST('1970-01-01 00:00:00' AS TIMESTAMP(0))) AS "f32", ("用户活跃表"."最后访问时间") IS NOT NULL AS "f33", COALESCE("用户活跃表"."用户id", '') AS "f34", ("用户活跃表"."用户id") IS NOT NULL AS "f35", COALESCE("用户活跃表"."用户名称", '') AS "f36", ("用户活跃表"."用户名称") IS NOT NULL AS "f37"
      FROM "PG_DEMO"."app分析"."用户活跃表" AS "用户活跃表"
      ORDER BY "用户活跃表"."访问次数", "用户活跃表"."累计访问天数", "用户活跃表"."访问时长", "用户活跃表"."统计日期", "用户活跃表"."最后访问时间"
             FETCH NEXT 10001 ROWS ONLY) AS "t1"
            LEFT JOIN (SELECT "t3"."访问次数的累计求和", "t3"."用户活跃表_累计访问天数_1", "t3"."用户活跃表_访问时长_4", "t3"."用户名称", "t3"."用户活跃表_最后访问时间_6", "t3"."用户活跃表_访问次数_2", "t3"."用户id", "t3"."最后访问时间", "t3"."累计访问天数", "t3"."访问时长", "t3"."访问次数", "t3"."用户活跃表_统计日期_7", "t3"."统计日期", COALESCE("t3"."用户活跃表_访问时长_4", 0) AS "f13", ("t3"."用户活跃表_访问时长_4") IS NOT NULL AS "f14", COALESCE("t3"."统计日期", TRY_CAST('1970-01-01' AS DATE)) AS "f15", ("t3"."统计日期") IS NOT NULL AS "f16", COALESCE("t3"."用户活跃表_访问次数_2", 0) AS "f17", ("t3"."用户活跃表_访问次数_2") IS NOT NULL AS "f18", COALESCE("t3"."用户活跃表_最后访问时间_6", TRY_CAST('1970-01-01 00:00:00' AS TIMESTAMP(0))) AS "f19", ("t3"."用户活跃表_最后访问时间_6") IS NOT NULL AS "f20", COALESCE("t3"."用户活跃表_统计日期_7", TRY_CAST('1970-01-01' AS DATE)) AS "f21", ("t3"."用户活跃表_统计日期_7") IS NOT NULL AS "f22", COALESCE("t3"."访问次数", 0) AS "f23", ("t3"."访问次数") IS NOT NULL AS "f24", COALESCE("t3"."访问时长", 0) AS "f25", ("t3"."访问时长") IS NOT NULL AS "f26", COALESCE("t3"."用户活跃表_累计访问天数_1", 0) AS "f27", ("t3"."用户活跃表_累计访问天数_1") IS NOT NULL AS "f28", COALESCE("t3"."累计访问天数", 0) AS "f29", ("t3"."累计访问天数") IS NOT NULL AS "f30", COALESCE("t3"."最后访问时间", TRY_CAST('1970-01-01 00:00:00' AS TIMESTAMP(0))) AS "f31", ("t3"."最后访问时间") IS NOT NULL AS "f32", COALESCE("t3"."用户id", '') AS "f33", ("t3"."用户id") IS NOT NULL AS "f34", COALESCE("t3"."用户名称", '') AS "f35", ("t3"."用户名称") IS NOT NULL AS "f36"
                       FROM (SELECT CASE WHEN (COUNT(TRY_CAST("t2"."访问次数" AS BIGINT)) OVER (ORDER BY "t2"."用户活跃表_访问次数_2", "t2"."用户活跃表_累计访问天数_1", "t2"."用户活跃表_访问时长_4", "t2"."用户活跃表_统计日期_7", "t2"."用户活跃表_最后访问时间_6" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) > 0 THEN COALESCE(SUM(TRY_CAST("t2"."访问次数" AS BIGINT)) OVER (ORDER BY "t2"."用户活跃表_访问次数_2", "t2"."用户活跃表_累计访问天数_1", "t2"."用户活跃表_访问时长_4", "t2"."用户活跃表_统计日期_7", "t2"."用户活跃表_最后访问时间_6" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 0) ELSE NULL END AS "访问次数的累计求和", "t2"."用户活跃表_累计访问天数_1", "t2"."用户活跃表_访问时长_4", "t2"."用户名称", "t2"."用户活跃表_最后访问时间_6", "t2"."用户活跃表_访问次数_2", "t2"."用户id", "t2"."最后访问时间", "t2"."累计访问天数", "t2"."访问时长", "t2"."访问次数", "t2"."用户活跃表_统计日期_7", "t2"."统计日期"
                             FROM (SELECT "用户活跃表0"."累计访问天数" AS "用户活跃表_累计访问天数_1", "用户活跃表0"."访问次数" AS "用户活跃表_访问次数_2", "用户活跃表0"."用户id" AS "用户活跃表_用户id_3", "用户活跃表0"."访问时长" AS "用户活跃表_访问时长_4", "用户活跃表0"."用户名称" AS "用户活跃表_用户名称_5", "用户活跃表0"."最后访问时间" AS "用户活跃表_最后访问时间_6", "用户活跃表0"."统计日期" AS "用户活跃表_统计日期_7", "用户活跃表0"."最后访问时间", "用户活跃表0"."累计访问天数", "用户活跃表0"."访问次数", "用户活跃表0"."用户id", "用户活跃表0"."统计日期", "用户活跃表0"."访问时长", "用户活跃表0"."用户名称"
                                   FROM "PG_DEMO"."app分析"."用户活跃表" AS "用户活跃表0") AS "t2") AS "t3"
                                   LEFT JOIN (VALUES (0)) AS "t4" ("col") ON TRUE
                       GROUP BY "t3"."访问次数的累计求和", "t3"."用户活跃表_累计访问天数_1", "t3"."用户活跃表_访问时长_4", "t3"."用户名称", "t3"."用户活跃表_最后访问时间_6", "t3"."用户活跃表_访问次数_2", "t3"."用户id", "t3"."最后访问时间", "t3"."累计访问天数", "t3"."访问时长", "t3"."访问次数", "t3"."用户活跃表_统计日期_7", "t3"."统计日期") AS "t7" ON "t1"."f14" = "t7"."f13" AND ("t1"."f15" = "t7"."f14" AND "t1"."f16" = "t7"."f15") AND ("t1"."f17" = "t7"."f16" AND ("t1"."f18" = "t7"."f17" AND "t1"."f19" = "t7"."f18")) AND ("t1"."f20" = "t7"."f19" AND ("t1"."f21" = "t7"."f20" AND "t1"."f22" = "t7"."f21") AND ("t1"."f23" = "t7"."f22" AND ("t1"."f24" = "t7"."f23" AND "t1"."f25" = "t7"."f24"))) AND ("t1"."f26" = "t7"."f25" AND ("t1"."f27" = "t7"."f26" AND "t1"."f28" = "t7"."f27") AND ("t1"."f29" = "t7"."f28" AND ("t1"."f30" = "t7"."f29" AND "t1"."f31" = "t7"."f30")) AND ("t1"."f32" = "t7"."f31" AND ("t1"."f33" = "t7"."f32" AND "t1"."f34" = "t7"."f33") AND ("t1"."f35" = "t7"."f34" AND ("t1"."f36" = "t7"."f35" AND "t1"."f37" = "t7"."f36"))))
ORDER BY "t1"."访问次数", "t1"."累计访问天数", "t1"."访问时长", "t1"."统计日期", "t1"."最后访问时间"
       FETCH NEXT 10001 ROWS ONLY